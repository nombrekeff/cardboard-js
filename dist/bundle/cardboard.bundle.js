var Cardboard=(()=>{var z=Object.defineProperty;var Oe=Object.getOwnPropertyDescriptor;var Me=Object.getOwnPropertyNames;var Le=Object.prototype.hasOwnProperty;var E=(r,e)=>{for(var t in e)z(r,t,{get:e[t],enumerable:!0})},Ne=(r,e,t,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of Me(e))!Le.call(r,n)&&n!==t&&z(r,n,{get:()=>e[n],enumerable:!(s=Oe(e,n))||s.enumerable});return r};var Ae=r=>Ne(z({},"__esModule",{value:!0}),r);var $e={};E($e,{CEvent:()=>P,CMappedEvent:()=>K,CTag:()=>N,Cardboard:()=>qe,Consumable:()=>L,Link:()=>Se,Router:()=>j,allTags:()=>D,arraysEqual:()=>ae,attach:()=>te,attached:()=>ve,camelToDash:()=>k,createConsumable:()=>T,deepEquals:()=>w,detach:()=>be,detachAll:()=>xe,each:()=>Ve,equalTo:()=>me,genBlock:()=>Y,genBlockContent:()=>F,genCss:()=>$,genStyle:()=>Q,getValue:()=>v,greaterThan:()=>ce,greaterThanOr:()=>de,init:()=>_e,intersect:()=>y,intersectMulti:()=>he,isArray:()=>q,isConsumable:()=>x,isEmpty:()=>Te,isObject:()=>S,lessThan:()=>fe,lessThanOr:()=>pe,listState:()=>Ie,makeRouter:()=>we,mappedEvent:()=>ue,notEmpty:()=>ye,notEqualTo:()=>ge,onLifecycle:()=>B,removeFromList:()=>A,router:()=>V,singleEvent:()=>le,state:()=>se,swapItems:()=>oe,tag:()=>O,text:()=>H,val:()=>b,withLifecycle:()=>Ce});var re={};E(re,{CTag:()=>N,allTags:()=>D,attach:()=>te,attached:()=>ve,detach:()=>be,detachAll:()=>xe,init:()=>_e,onLifecycle:()=>B,tag:()=>O,withLifecycle:()=>Ce});var Z={};E(Z,{genBlock:()=>Y,genBlockContent:()=>F,genCss:()=>$,genStyle:()=>Q});var J={};E(J,{arraysEqual:()=>ae,camelToDash:()=>k,deepEquals:()=>w,isArray:()=>q,isObject:()=>S,removeFromList:()=>A,swapItems:()=>oe,val:()=>b});var A=(r,e)=>{if(!e)return!1;let t=e.indexOf(r);return t!==-1?(e.splice(t,1),!0):!1},k=r=>r.replace(/([A-Z])/g,e=>`-${e.toLowerCase()}`),S=r=>typeof r=="object"&&!(r instanceof Array),q=r=>Object.prototype.toString.call(r)==="[object Array]",b=(r,...e)=>typeof r=="function"?r(...e):r,oe=(r,e,t)=>{let s=r[e];return r[e]=r[t],r[t]=s,r},ae=(r,e)=>{if(r===e)return!0;if(r==null||e==null||r.length!==e.length)return!1;for(let t=0;t<r.length;++t)if(r[t]!==e[t])return!1;return!0},w=(r,e)=>{if(r===e)return!0;if(r&&e&&typeof r=="object"&&typeof e=="object"){if(r.constructor!==e.constructor)return!1;var t,s,n;if(Array.isArray(r)){if(t=r.length,t!=e.length)return!1;for(s=t;s--!==0;)if(!w(r[s],e[s]))return!1;return!0}if(r.constructor===RegExp)return r.source===e.source&&r.flags===e.flags;if(r.valueOf!==Object.prototype.valueOf)return r.valueOf()===e.valueOf();if(r.toString!==Object.prototype.toString)return r.toString()===e.toString();if(n=Object.keys(r),t=n.length,t!==Object.keys(e).length)return!1;for(s=t;s--!==0;)if(!Object.prototype.hasOwnProperty.call(e,n[s]))return!1;for(s=t;s--!==0;){var i=n[s];if(!w(r[i],e[i]))return!1}return!0}return r!==r&&e!==e};var $=r=>{let e=r instanceof Array?r:[r],t="";for(let s of e)for(let n in s)t+=Y(n,s[n]);return t},Y=(r,e)=>F(r,e).join(""),F=(r,e)=>{let t="",s=[];for(let n in e)S(e[n])?s.push(...F(r+n,e[n])):e[n]&&(t+=Q(n,e[n]));return s.unshift(`${r}{${t}}`),s},Q=(r,e)=>`${k(r)}:${e};`;var ee={};E(ee,{text:()=>H});var X={};E(X,{Consumable:()=>L,createConsumable:()=>T,equalTo:()=>me,getValue:()=>v,greaterThan:()=>ce,greaterThanOr:()=>de,intersect:()=>y,intersectMulti:()=>he,isConsumable:()=>x,isEmpty:()=>Te,lessThan:()=>fe,lessThanOr:()=>pe,notEmpty:()=>ye,notEqualTo:()=>ge});var G={};E(G,{CEvent:()=>P,CMappedEvent:()=>K,mappedEvent:()=>ue,singleEvent:()=>le});var P=class{constructor(){this._listeners=[]}listen(e){this._listeners.push(e)}remove(e){A(e,this._listeners)}dispatch(e){this._listeners.forEach(t=>t(e))}},K=class{constructor(){this._listeners={}}listen(e,t){e in this._listeners?this._listeners[e]&&this._listeners[e].push(t):this._listeners[e]=[t]}remove(e,t){A(t,this._listeners[e])}dispatch(e,t){e in this._listeners&&this._listeners[e].forEach(s=>s(t))}},le=()=>new P,ue=()=>new K;var L=class extends P{constructor(t){super();t&&(S(t)||q(t))&&(t=new Proxy(t,{get(s,n,i){return s[n]},set:(s,n,i,a)=>(s[n]===i||(s[n]=i,super.dispatch(s)),!0),deleteProperty:(s,n)=>(delete s[n],super.dispatch(s),!0)})),this._value=t,this._prev=t}get value(){return this._value}set value(t){this.dispatch(t)}get prev(){return this._prev}valueOf(){return this._value}toString(){return this._value.toString()}changed(t){return this.listen(t),this}dispatch(t){return t===this._value?this:(this._prev=this._value,this._value=t,super.dispatch(t),this)}intersect(t){return y(this,t)}},x=r=>r instanceof L,T=r=>new L(r),y=(r,e)=>{let t=T(e(r.value));return r.changed(s=>t.dispatch(e(s))),t},he=(r,e)=>{let t=T(e(...r.map(s=>s.value)));for(let s of r)s.changed(()=>t.dispatch(e(...r.map(n=>n.value))));return t},v=r=>x(r)?r.value:r,ce=(r,e=0)=>y(r,t=>t>v(e)),de=(r,e=0)=>y(r,t=>t>=v(e)),fe=(r,e=0)=>y(r,t=>t<v(e)),pe=(r,e=0)=>y(r,t=>t<=v(e)),me=(r,e)=>y(r,t=>t===v(e)),ge=(r,e)=>y(r,t=>t!==v(e)),Te=r=>y(r,e=>e.length<=0),ye=r=>y(r,e=>e.length>0);var H=(r,e)=>{let t=document.createTextNode(""),s=/\B\$([0-9]+|[a-z][a-z0-9_$]*)/gi,n=i=>{t.nodeValue=i?r.replace(s,(a,o)=>(i[o]??a).toString()):r};if(!e)t.nodeValue=r;else if(x(e))e.changed(i=>n(i)),n(e.value);else if(S(e)){for(let i of Object.getOwnPropertyNames(e))r.includes(`$${i}`)&&x(e[i])&&e[i].changed(()=>n(e));n(e)}return t};var m={attached:void 0,stack:[]},ve=()=>m.attached,N=class r{constructor(e,t=[],s=!1){this._children=[];this._cachedChildren=[];this._attachable=!1;this._meta={isHidden:!1,nextSiblingID:null};if(this._attachable=!1,typeof e=="string"&&e.match(/\(.+\)/)){let i=e.match(/\((.+)\)/),a=i?i[1]:null;if(!a)throw new Error("Invalid selector: "+e);let o=document.querySelector(a);if(!o)throw new Error("Can't find element for selector: "+e);this.el=o}else if(typeof e=="string")this._attachable=s,this.el=document.createElement(e);else if(e instanceof HTMLElement)this.el=e;else throw new Error("Invalid argument 0");m.attached&&this._attachable&&m.attached.append(this),t.length>0&&this.setChildren(t)}get parent(){return this._parent}set parent(e){this._parent=e}get children(){return this._getChildren(this.el),this._cachedChildren}get value(){return this.el.value}setValue(e){return this.el.value=e,this}get checked(){return this.el.checked}setChecked(e){return this.el.checked=e,this}get style(){return this.el.style}get className(){return this.el.className}get classList(){return this.el.classList}get consumeValue(){let e=this.value;return this.clear(),e}get id(){return this.el.id}setId(e){return this.el.id=e,this}setChildren(e){return this.el.replaceChildren(...this._mapChildren(e)),this._children=e,this}append(...e){return this.el.append(...this._mapChildren(e)),this._children.push(...e),this}prepend(...e){return this.el.prepend(...this._mapChildren(e)),this._children.unshift(...e),this}async show(){if(this.parent&&!this.parent.children.includes(this.el)){let e=this.parent.el,t=this.parent._children.indexOf(this);if(t===0)e.prepend(this.el);else if(t===this.parent._children.length-1)e.append(this.el);else{let s=0;for(let i=t-1;i>=0;i--){let a=this.parent._children[i];a instanceof r&&a._meta.isHidden&&s++}let n=e.childNodes[t-s];e.insertBefore(this.el,n)}}return this._meta.isHidden=!1,!0}async hide(){this.parent&&this.parent.children.includes(this.el)&&(await this.remove(),this._meta.isHidden=!0)}consume(e,t){return e.changed?e.changed(s=>{t(this,s)}):console.warn("An invalid Consumable was supplied to `tag.consume`"),t(this,"value"in e?e.value:e),this}doIf(e,t,s,n=!1){if(n){let a=t;t=s,s=a}let i=(a,o)=>{o?t(o):s(o)};return this.consume(e,i)}doIfNot(e,t,s){return this.doIf(e,t,s,!0)}hideIf(e,t=!1){let s=(n,i)=>{let a=t?!i:!!i;this._meta.isHidden=a,this.parent&&(a?this.hide():this.show())};return this.consume(e,s)}hideIfNot(e){return this.hideIf(e,!0)}classIf(e,t,s=!1){return this.doIf(e,()=>this.addClass(...b(t,this)),()=>this.rmClass(...b(t,this)),s)}classIfNot(e,t){return this.classIf(e,t,!0)}textIf(e,t,s="",n=!1){return this.doIf(e,()=>this.text(b(t,this)),()=>this.text(b(s,this)),n)}textIfNot(e,t,s=""){return this.textIf(e,t,s,!0)}attrIf(e,t,s="",n=!1){return this.doIf(e,()=>this.addAttr(t,b(s,this)),()=>this.rmAttr(t),n)}attrIfNot(e,t,s=""){return this.attrIf(e,t,s,!0)}disableIf(e,t=!1){return this.attrIf(e,"disabled","",t)}disableIfNot(e){return this.disableIf(e,!0)}styleIf(e,t,s="",n=!1){return this.doIf(e,()=>this.addStyle(t,b(s,this)),()=>this.rmStyle(t),n)}styleIfNot(e,t,s=""){return this.styleIf(e,t,s,!0)}stylesIf(e,t,s=!1){return this.doIf(e,()=>this.setStyle(b(t,this)),()=>this.rmStyle(...Object.keys(t)),s)}stylesIfNot(e,t){return this.stylesIf(e,t,!0)}listen(e,t,s){return e.on(t,(n,i)=>{s(this,n,i)})}text(e,t){return e==null?this.el.textContent:t&&e?this.setChildren([H(e,t)]):(this.el.textContent=e,this)}config(e){if(e.attr&&this.setAttrs(e.attr),e.classList&&this.addClass(...e.classList),e.className&&this.setClassName(e.className),e.style&&this.setStyle(e.style),e.text&&this.text(e.text),e.value&&this.setValue(e.value),e.children&&this.append(...e.children),e.on)for(let t of Object.keys(e.on))this.on(t,e.on[t]);return this}addClass(...e){return this.classList.add(...e),this}setClassName(e){return this.el.className=e,this}rmClass(...e){for(let t of e)this.classList.remove(t);return this}hasClass(...e){for(let t of e)if(!this.classList.contains(t))return!1;return!0}replaceClass(e,t){return this.classList.replace(e,t),this}toggleClass(e){return this.hasClass(e)?this.rmClass(e):this.addClass(e)}addStyle(e,t){return this.el.style[e]=t,this}setStyle(e){for(let t in e)this.addStyle(t,e[t]??"");return this}rmStyle(...e){for(let t of e)this.style.removeProperty(k(t));return this}hasStyle(...e){for(let t of e)if(!this.style.getPropertyValue(k(t)))return!1;return!0}setAttrs(e){for(let t in e)this.addAttr(t,e[t]);return this}addAttr(e,t=""){return this.el.attributes[e]=t,this.el.setAttribute(e,t),this}rmAttr(...e){for(let t of e)this.el.removeAttribute(t),delete this.el.attributes[t];return this}hasAttr(...e){for(let t of e)if(!(t in this.el.attributes))return!1;return!0}getAttr(e){return this.el.attributes[e]}when(e,t){let s=T({});return this.on(e,(n,i)=>{s.dispatch(t(n,i))}),s}on(e,t){return t&&this.el.addEventListener(e,s=>{t(this,s)}),this}once(e,t){let s=n=>{t(this,n),this.el.removeEventListener(e,s)};return this.el.addEventListener(e,s),this}clicked(e){return this.on("click",e)}keyPressed(e,t){return t?this.on("keypress",(s,n)=>{(n.code===t||n.key===t)&&e(this,n)}):this.on("keypress",e)}changed(e){return this.on("change",e)}submited(e){return this.on("submit",e)}async remove(){let e=this.el.remove();return e instanceof Promise&&await e,await this.el.remove(),this}clear(){return this.el.value="",this.el.dispatchEvent(new InputEvent("input")),this}disable(){return this.setDisabled(!0)}enable(){return this.setDisabled(!1)}setDisabled(e){return e?this.addAttr("disabled"):this.rmAttr("disabled")}q(e){let t=this.el.querySelector(e);if(t)return new r(t)}find(e){for(let t of this._children)if(e(t))return t}findTag(e){for(let t of this._children)if(t instanceof r&&e(t))return t}_setChildrenParent(e){return e instanceof r&&(e.parent=this),e}_childrenFilterPredicate(e){return!(e instanceof r&&e._meta.isHidden)}_getElementForChild(e){return typeof e=="string"?document.createTextNode(e):x(e)?H("$val",{val:e}):e instanceof r?e.el:e instanceof Node?e:null}_getChildren(e){this._observer||(this._observer=new MutationObserver(()=>{this._cacheChildren(e)}),this._observer.observe(this.el,{childList:!0}),this._cacheChildren(e))}_cacheChildren(e){let t=e.childNodes,s=[],n=t.length;for(;n--;)t[n].nodeType===1&&s.unshift(t[n]);this._cachedChildren=s}_mapChildren(e){return e.map(this._setChildrenParent.bind(this)).filter(this._childrenFilterPredicate.bind(this)).map(this._getElementForChild).filter(t=>t!=null)}},O=(r,e=[],t=!1)=>new N(r,e,t),B=(r,e,t,s)=>{let n=!1;if(s){let a=r.el.remove;r.el.remove=async()=>{let o=s(r);return(!o||o instanceof Promise&&await o)&&a.call(r.el),o.valueOf()}}if(e){let a=r.show;r.show=async()=>{let o=a.call(r);return o instanceof Promise?await o:o}}let i=new MutationObserver(async(a,o)=>{let c=!1,_=!1;for(let C of a)e&&Array.from(C.addedNodes).includes(r.el)&&(c=!0),t&&Array.from(C.removedNodes).includes(r.el)&&(_=!0);if(c&&e){let C=e(r);C instanceof Promise&&await C,!n&&r.el.parentElement&&(o.disconnect(),o.observe(r.el.parentElement,{childList:!0}),n=!0)}_&&t&&t(r)});return i.observe(r.parent?.el??document.body,{childList:!0,subtree:!0}),i},Ce=(r,e)=>(B(r,e.start,e.removed,e.beforeRemove),r),te=r=>(m.attached&&m.stack.push(m.attached),m.attached=r,r),be=()=>{m.stack.length>0?m.attached=m.stack.pop():m.attached=void 0},xe=()=>{m.attached=void 0,m.stack=[]},_e=(r={root:"body"})=>{let e=new N(`(${r.root})`);return te(e),e},W={ul:(r,e=!1)=>O("ul",r.map(t=>O("li",[t],e))),style:(r,e=!1)=>O("style",[$(r)],e)},D=new Proxy({},{get:(r,e,t)=>{let s=e.toString(),n=(...i)=>W[s]?W[s](i,!1):O(s,i);return Object.defineProperty(n,"attach",{get:()=>(...i)=>W[s]?W[s](i,!0):O(s,i,!0)}),n}});var ne={};E(ne,{listState:()=>Ie,state:()=>se});var se=r=>T(r),Ie=r=>{let e=se(r.map(o=>T(o))),t=e.intersect(o=>o.length),s=(o,c=!1)=>{e.value=[...e.value,T(o)]},n=(o,c)=>{let _=[...e.value];_.splice(c,0,T(o)),e.value=_},i=o=>{e.value=e.value.filter(o)};return{get list(){return e},get listValue(){return e.value},add:s,addAt:n,remove:o=>{i(c=>!w(v(c),v(o)))},removeWhere:i,length:t}};var ie={};E(ie,{Link:()=>Se,Router:()=>j,makeRouter:()=>we,router:()=>V});var Ke=/[-[\]{}()+?.,\\^$|#\s]/g,Re=/([:*])(\w+)/g;function He(r,e){let t=r.toString(r).charAt(8);return t==="R"?r.test(e):t==="F"?r(e):r==e}var Ee=(r,e={})=>{let t={},s=[],n=r;return typeof n=="string"?(n=n.replace(Ke,"\\$&"),n=n.replace(Re,function(i,a,o){return s.push(o),a===":"?"([^/]*)":"(.*)"}),n=new RegExp("^"+n+"$"),t.parse=function(i){let a=0,o,c,_={},C=i.match(n);if(!C)return null;for(;a<s.length;){if(o=s[a++],c=C[a],e&&o in e&&!He(e[o],c))return null;_[o]=c}return _},t.stringify=function(i){let a,o,c=r;for(a in i)o=new RegExp("[:*]"+a+"\\b"),c=c.replace(o,i[a]);return c.replace(Re,"")}):(t.parse=function(i){let a=i.match(n);return a&&{captures:a.slice(1)}},t.stringify=function(){return""}),t};var{div:Be,a:je}=D,j=class{constructor(e){this._routes={};this._routeMatchers=[];this.params={};this.query=new URLSearchParams;this._options=e,this._rootParent=e.rootParent,this._window=e.window??window,this._location=this._window.location,this._history=this._window.history,this._initRouteMatchers(),this._modifyPushState(),this._listenEvents(),this.navigate(this._options.initialRoute)}get currentRoute(){return this._currentRoute}navigate(e,t){let s=new URLSearchParams(t),n=s.toString(),i=this.query.toString();(e!==this._currentRoute||n!==i)&&(this.query=s,this._history.pushState("data","",e+(n?"?"+n:"")))}async _setRoute(){this._currentTag&&await this._currentTag.hide();let e=this._getRoute();e.parent?await e.show():(this._hookLifecycle(e),this._rootParent.append(e)),this._currentTag=e}_hookLifecycle(e){let t=this._options;!t.remove&&!t.start||B(e,t.start,t.remove,t.beforeRemove)}_getEffectiveRoute(){if(!this._currentRoute)return;let e=this._currentRoute,t=1e4,s;for(;typeof(s=this._options.routes[e])=="string"&&t--&&typeof s=="string";)e=s;return e}_getRoute(){let e=this._getEffectiveRoute(),t=this._options,s=e,n=!1;this.query=new URLSearchParams(this._location.search);for(let{matcher:a,key:o}of this._routeMatchers){let c=a.parse(s);if(c){this.params=c,s=o,n=!0;break}}if(n||(s=t.fallbackRoute),!(s in t.routes))return t.noRouteBuilder?t.noRouteBuilder(this):Be("No route found for: "+e);if(this._routes[s])return this._routes[s].show(),this._routes[s];let i=t.routes[s];if(typeof i!="function")throw new Error("Can't find route builder for "+this._currentRoute);return this._routes[s]=i(this)}_setCurrentRoute(){this.currentRoute!==this._location.pathname&&(this._currentRoute=this._location.pathname,this._setRoute())}_listenEvents(){this._window.addEventListener("popstate",this._setCurrentRoute.bind(this)),this._window.addEventListener("pushstate",this._setCurrentRoute.bind(this))}_modifyPushState(){let e=this._history.pushState;this._history.pushState=(...t)=>{e.call(this._history,...t),this._window.dispatchEvent(new window.Event("pushstate"))}}_initRouteMatchers(){for(let e in this._options.routes)this._routeMatchers.push({key:e,matcher:Ee(e)})}},V,we=r=>V=new j(r),Se=(r,e,t)=>je(r).addAttr("href","javascript:;").setStyle({margin:"0 8px 0 0"}).clicked(()=>{if(!V)throw new Error("Link can	 navigate, there is no router available");V.navigate(e,t)});function Ve(r,e){let t=document.createTextNode(""),s=[],n=[],i=0,a=[],o=[],c=(u,d)=>{if(d>=0){let I=e(u),l=s[d];s.splice(d,0,I),t.parentElement?.insertBefore(I.el,l?l.el:t)}},_=(u,d)=>{},C=(u,d)=>{if(u>=0&&d>=0){let I=o[u],l=o[d],f=I.el.parentNode,M=I.el.nextSibling;f&&M===l.el?f.insertBefore(l.el,I.el):l.el.parentNode&&(l.el.parentNode.insertBefore(I.el,l.el),M&&f?f.insertBefore(l.el,M):f&&f.appendChild(l.el));let h=o[u];o[u]=o[d],o[d]=h;let p=s[u];s[u]=s[d],s[d]=p}},ke=u=>{t.parentElement?.removeChild(s[u].el),s.splice(u,1),o.splice(u,1)},U=u=>{if(!t.parentElement){setTimeout(()=>U(u),1);return}let d=performance.now();if(u.length===n.length&&w(n,u)){let l=performance.now()-d;console.log("Each Fast skip took: "+l.toFixed(2)+"ms");return}if(a=Array.from(t.parentElement?.childNodes??[]),i||(i=a.indexOf(t)),n.length){let l=[],f=0,M=0;for(let h=0;h<n.length;h++){let p=u[h-f],R=n[h],g=n.indexOf(p);if(R!==p){if(p&&g<0)l.push({entry:p,state:"added",index:h-f}),f--,M++;else if(!u.includes(R)||g===void 0&&R!==void 0&&(p==null||p!==R))l.push({entry:R,state:"removed",index:h}),f++;else if(u.indexOf(R)>=0){l.push({entry:p,targetEntry:R,state:"swap",index:n.indexOf(u[h-f]),targetIndex:n.indexOf(n[h])});let Pe=n[h];n[h]=u[h-f],n[g]=Pe}}}for(let h=n.length;h<u.length-M;h++){let p=u[h];l.push({entry:p,state:"added",index:h})}for(let h=0;h<l.length;h++){let p=l[h+1]?l[h+1].index:null,R=l[h+1]?l[h+1].state:null,g=l[h];switch(g.state){case"added":c(g.entry,g.index);break;case"removed":ke(g.index);break;case"swap":C(g.index,g.targetIndex??-1),R==="swap"&&p===g.targetIndex&&h++;break;default:}}}else for(let l=0;l<u.length;l++)c(u[l],l);n=u.slice(0),o=s.slice(0);let I=performance.now()-d;console.log("Each Fast took: "+I.toFixed(2)+"ms")};return setTimeout(()=>U("value"in r?r.value:r),1),x(r)&&r.changed(U),t}var qe={...re,...ne,...Z,...J,...ee,...G,...ie,...X};return Ae($e);})();
