var Cardboard=(()=>{var M=Object.defineProperty;var X=Object.getOwnPropertyDescriptor;var Y=Object.getOwnPropertyNames;var ee=Object.prototype.hasOwnProperty;var f=(r,e)=>{for(var t in e)M(r,t,{get:e[t],enumerable:!0})},te=(r,e,t,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of Y(e))!ee.call(r,n)&&n!==t&&M(r,n,{get:()=>e[n],enumerable:!(s=X(e,n))||s.enumerable});return r};var re=r=>te(M({},"__esModule",{value:!0}),r);var le={};f(le,{CEvent:()=>m,CMappedEvent:()=>y,CTag:()=>v,Cardboard:()=>oe,CssGenerator:()=>T,Link:()=>Z,Router:()=>x,allTags:()=>S,attach:()=>I,attached:()=>V,camelToDash:()=>C,detach:()=>D,detachAll:()=>F,fromJson:()=>$,init:()=>J,isArray:()=>R,isObject:()=>p,makeRouter:()=>Q,mappedEvent:()=>z,onLifecycle:()=>b,removeFromList:()=>_,router:()=>w,singleEvent:()=>U,state:()=>H,tag:()=>g,text:()=>E,toJson:()=>B,val:()=>d,withLifecycle:()=>q});var A={};f(A,{CTag:()=>v,allTags:()=>S,attach:()=>I,attached:()=>V,detach:()=>D,detachAll:()=>F,init:()=>J,onLifecycle:()=>b,tag:()=>g,withLifecycle:()=>q});var P={};f(P,{CssGenerator:()=>T});var L={};f(L,{camelToDash:()=>C,fromJson:()=>$,isArray:()=>R,isObject:()=>p,removeFromList:()=>_,toJson:()=>B,val:()=>d});function _(r,e){if(!e)return!1;let t=e.indexOf(r);return t!==-1?(e.splice(t,1),!0):!1}var C=r=>r.replace(/([A-Z])/g,e=>`-${e.toLowerCase()}`);function p(r){return typeof r=="object"&&!(r instanceof Array)}function R(r){return Object.prototype.toString.call(r)==="[object Array]"}var B=r=>JSON.parse(r),$=r=>JSON.stringify(r),d=(r,...e)=>typeof r=="function"?r(...e):r;var T=class{genCss(e){let t=e instanceof Array?e:[e],s="";for(let n of t)for(let i in n)s+=this.genBlock(i,n[i]);return s}genBlock(e,t){return this.genBlockContent(e,t).join("")}genBlockContent(e,t){let s="",n=[];for(let i in t)p(t[i])?n.push(this.genBlockContent(e+i,t[i])):t[i]&&(s+=this.genStyle(i,t[i]));return n.unshift(`${e}{${s}}`),n}genStyle(e,t){return`${C(e)}:${t};`}};var N={};f(N,{text:()=>E});function E(r,e){let t=document.createTextNode(""),s=/\B\$([0-9]+|[a-z][a-z0-9_$]*)/gi,n=()=>{t.nodeValue=e?r.replace(s,(i,o)=>e[o]!=null?e[o].toString():i):r};if(e&&"changed"in e)for(let i of Object.getOwnPropertyNames(e))r.includes(`$${i}`)&&e[i].changed(n);return n(),t}var u={attached:null,stack:[],css:new T};function V(){return u.attached}var v=class r{constructor(e,t=[],s=!1){this._parent=null;this._children=[];this._cachedChildren=[];this._attachable=!1;this._meta={isHidden:!1,nextSiblingID:null};if(this._attachable=!1,typeof e=="string"&&e.match(/\(.+\)/))this.element=document.querySelector(e.match(/\((.+)\)/)[1]);else if(typeof e=="string")this._attachable=s,this.element=document.createElement(e);else if(e instanceof HTMLElement)this.element=e;else throw new Error("Invalid argument 0");u.attached&&this._attachable&&u.attached.append(this),t.length>0&&this.setChildren(t)}get parent(){return this._parent}set parent(e){this._parent=e}get children(){return this._getChildren(this.element),this._cachedChildren}get value(){return this.element.value}get style(){return this.element.style}get className(){return this.element.className}get classList(){return this.element.classList}setValue(e){return this.element.value=e,this}get consumeValue(){let e=this.value;return this.clear(),e}get id(){return this.element.id}setId(e){return this.element.id=e,this}setChildren(e){return this.element.replaceChildren(...this._mapChildren(e)),this._children=e,this}append(...e){return this.element.append(...this._mapChildren(e)),this._children.push(...e),this}prepend(...e){return this.element.prepend(...this._mapChildren(e)),this._children.unshift(...e),this}consume(e,t){return e.changed(s=>t(this,s)),t(this,e),this}async show(){if(!this.parent.children.includes(this.element)){let e=this.parent.element,t=this.parent._children.indexOf(this);if(t==0)e.prepend(this.element);else if(t==this.parent._children.length-1)e.append(this.element);else{let s=0;for(let i=t-1;i>=0;i--){let o=this.parent._children[i];o instanceof r&&o._meta.isHidden&&s++}let n=e.childNodes[t-s];e.insertBefore(this.element,n)}}return this._meta.isHidden=!1,!0}async hide(){this.parent.children.includes(this.element)&&(await this.remove(),this._meta.isHidden=!0)}doIf(e,t,s,n=!1){if(n){let o=t;t=s,s=o}let i=o=>{o?t(o):s(o)};return e.changed(i),i(e),this}doIfNot(e,t,s){return this.doIf(e,t,s,!0)}hideIf(e,t=!1){let s=n=>{let i=t?!n:!!n;this._meta.isHidden=i,this.parent&&(i?this.hide():this.show())};return e.changed(s),s(e),this}hideIfNot(e){return this.hideIf(e,!0)}classIf(e,t,s=!1){return this.doIf(e,()=>this.addClass(...d(t,this)),()=>this.rmClass(...d(t,this)),s)}classIfNot(e,t){return this.classIf(e,t,!0)}textIf(e,t,s="",n=!1){return this.doIf(e,()=>this.text(d(t,this)),()=>this.text(d(s,this)),n)}textIfNot(e,t,s=""){return this.textIf(e,t,s,!0)}attrIf(e,t,s="",n=!1){return this.doIf(e,()=>this.addAttr(t,d(s,this)),()=>this.rmAttr(t),n)}attrIfNot(e,t,s=""){return this.attrIf(e,t,s,!0)}disableIf(e,t=!1){return this.attrIf(e,"disabled","",t)}disableIfNot(e){return this.disableIf(e,!0)}styleIf(e,t,s="",n=!1){return this.doIf(e,()=>this.addStyle(t,d(s,this)),()=>this.rmStyle(t),n)}styleIfNot(e,t,s=""){return this.styleIf(e,t,s,!0)}stylesIf(e,t,s=!1){return this.doIf(e,()=>this.setStyle(d(t,this)),()=>this.rmStyle(...Object.keys(t)),s)}stylesIfNot(e,t){return this.stylesIf(e,t,!0)}listen(e,t,s){return e.on(t,(n,i)=>s(this,n,i))}text(e,t){return e==null?this.element.textContent:t&&e?this.setChildren([E(e,t)]):(this.element.textContent=e,this)}config(e){if(e.attr&&this.setAttrs(e.attr),e.classList&&this.addClass(...e.classList),e.className&&this.setClassName(e.className),e.style&&this.setStyle(e.style),e.text&&this.text(e.text),e.value&&this.setValue(e.value),e.children&&this.append(...e.children),e.on)for(let t in e.on)this.on(t,e.on[t]);return this}addClass(...e){return this.classList.add(...e),this}setClassName(e){return this.element.className=e,this}rmClass(...e){for(let t of e)this.classList.remove(t);return this}hasClass(...e){for(let t of e)if(!this.classList.contains(t))return!1;return!0}replaceClass(e,t){return this.classList.replace(e,t),this}toggleClass(e){return this.hasClass(e)?this.rmClass(e):this.addClass(e)}addStyle(e,t){return this.element.style[e]=t,this}setStyle(e){for(let t in e)this.addStyle(t,e[t]);return this}rmStyle(...e){for(let t of e)this.style.removeProperty(t);return this}hasStyle(...e){for(let t of e)if(!this.style.getPropertyValue(C(t)))return!1;return!0}setAttrs(e){for(let t in e)this.addAttr(t,e[t]);return this}addAttr(e,t=""){return this.element.attributes[e]=t,this.element.setAttribute(e,t),this}rmAttr(...e){for(let t of e)this.element.removeAttribute(t),delete this.element.attributes[t];return this}hasAttr(...e){for(let t of e)if(!(t in this.element.attributes))return!1;return!0}getAttr(e){return this.element.attributes[e]}when(e,t){return{changed:s=>{this.on(e,()=>s(t(this)))}}}on(e,t){return this.element.addEventListener(e,s=>t(this,s)),this}once(e,t){let s=n=>{t(this,n),this.element.removeEventListener(e,s)};return this.element.addEventListener(e,s),this}clicked(e){return this.on("click",e)}keyPressed(e,t){return t?this.on("keypress",(s,n)=>{(n.code==t||n.key==t)&&e(this,n)}):this.on("keypress",e)}changed(e){return this.on("change",e)}submited(e){return this.on("submit",e)}async remove(){return await this.element.remove(),this}clear(){return this.element.value="",this.element.dispatchEvent(new InputEvent("input")),this}disable(){return this.setDisabled(!0)}enable(){return this.setDisabled(!1)}setDisabled(e){return e?this.addAttr("disabled"):this.rmAttr("disabled")}q(e){let t=this.element.querySelector(e);if(t)return new r(t)}find(e){for(let t of this._children)if(e(t))return t}findTag(e){for(let t of this._children)if(t instanceof r&&e(t))return t}_setChildrenParent(e){return e instanceof r&&(e.parent=this),e}_childrenFilterPredicate(e){return!(e instanceof r&&e._meta.isHidden)}_getElementForChild(e){return typeof e=="string"?document.createTextNode(e):e instanceof r?e.element:e instanceof Node?e:null}_getChildren(e){this._observer||(this._observer=new MutationObserver(()=>{this._cacheChildren(e)}),this._observer.observe(this.element,{childList:!0}),this._cacheChildren(e))}_cacheChildren(e){let t=e.childNodes,s=[],n=t.length;for(;n--;)t[n].nodeType==1&&s.unshift(t[n]);this._cachedChildren=s}_mapChildren(e){return e.map(this._setChildrenParent.bind(this)).filter(this._childrenFilterPredicate.bind(this)).map(this._getElementForChild)}};function g(r,e=[],t=!1){return new v(r,e,t)}function b(r,e,t,s){let n=!1;if(s){let o=r.element.remove;r.element.remove=async()=>{let a=s(r);return(!a||a instanceof Promise&&await a)&&o.call(r.element),a}}if(e){let o=r.show;r.show=async()=>{let a=o.call(r);return a instanceof Promise?await a:a}}let i=new MutationObserver(async(o,a)=>{let l=!1,h=!1;for(let c of o)e&&Array.from(c.addedNodes).includes(r.element)&&(l=!0),t&&Array.from(c.removedNodes).includes(r.element)&&(h=!0);if(l&&e){let c=e(r);c instanceof Promise&&await c,n||(a.disconnect(),a.observe(r.element.parentElement,{childList:!0}),n=!0)}h&&t&&t(r)});return i.observe(r.parent?.element??document.body,{childList:!0,subtree:!0}),i}var q=(r,e)=>(b(r,e.start,e.removed,e.beforeRemove),r);function I(r){return u.attached&&u.stack.push(u.attached),u.attached=r,r}function D(){u.stack.length>0?u.attached=u.stack.pop():u.attached=null}function F(){u.attached=null,u.stack=[]}function J(r={root:"body"}){let e=new v(`(${r.root})`);return I(e),e}var k={ul:(r,e=!1)=>g("ul",r.map(t=>g("li",[t],e))),style:(r,e=!1)=>g("style",[u.css.genCss(r)],e)},S=new Proxy({},{get:(r,e,t)=>{let s=e.toString(),n=(...i)=>k[s]?k[s](i,!1):g(s,i);return Object.defineProperty(n,"attach",{get:()=>(...i)=>k[s]?k[s](i,!0):g(s,i,!0)}),n}});var O={};f(O,{state:()=>H});var K={};f(K,{CEvent:()=>m,CMappedEvent:()=>y,mappedEvent:()=>z,singleEvent:()=>U});var m=class{constructor(){this._listeners=[]}listen(e){return this._listeners.push(e),this}remove(e){_(e,this._listeners)}dispatch(e){return this._listeners.forEach(t=>t(e)),this}},y=class{constructor(){this._listeners={}}listen(e,t){e in this._listeners?this._listeners[e].push(t):this._listeners[e]=[t]}remove(e,t){_(t,this._listeners[e])}dispatch(e,t){e in this._listeners&&this._listeners[e].forEach(s=>s(t))}};function U(){return new m}function z(){return new y}function H(r,e){let t=new y,s=new m;e&&s.listen(e);let n=(a,l)=>{t.dispatch(l,a[l]),s.dispatch(a)},i=(a,l)=>{let h=a[l];try{p(h)?h.changed=c=>t.listen(l,c):h.__proto__&&(h.__proto__.changed=c=>t.listen(l,c))}catch{}return h};for(let a of Object.getOwnPropertyNames(r)){let l=r[a];(p(l)||R(l))&&(r[a]=H(l,n.bind(this,r,a)))}let o=new Proxy(r,{deleteProperty:function(a,l){return n(a,l),delete a[l],!0},get:(a,l)=>i(a,l),set:(a,l,h)=>l=="changed"?(a[l]=h,!0):(a[l]=h,n(a,l),!0)});return o.changed=a=>s.listen(a),o}var j={};f(j,{Link:()=>Z,Router:()=>x,makeRouter:()=>Q,router:()=>w});var se=/[\-\[\]{}()+?.,\\\^$|#\s]/g,W=/([:*])(\w+)/g;function ne(r,e){var t=r.toString.call(r).charAt(8);return t==="R"?r.test(e):t==="F"?r(e):r==e}var G=(r,e={})=>{let t={},s=[],n=r;return typeof n=="string"?(n=n.replace(se,"\\$&"),n=n.replace(W,function(i,o,a){return s.push(a),o===":"?"([^/]*)":"(.*)"}),n=new RegExp("^"+n+"$"),t.parse=function(i){let o=0,a,l,h={},c=i.match(n);if(!c)return null;for(;o<s.length;){if(a=s[o++],l=c[o],e&&a in e&&!ne(e[a],l))return null;h[a]=l}return h},t.stringify=function(i){let o,a,l=r;for(o in i)a=new RegExp("[:*]"+o+"\\b"),l=l.replace(a,i[o]);return l.replace(W,"")}):(t.parse=function(i){let o=i.match(n);return o&&{captures:o.slice(1)}},t.stringify=function(){return""}),t};var{div:ie,a:ae}=S,x=class{constructor(e){this._routes={};this._routeMatchers=[];this.params={};this.query=new URLSearchParams;this._options=e,this._rootParent=e.rootParent,this._window=e.window??window,this._location=this._window.location,this._history=this._window.history,this._initRouteMatchers(),this._modifyPushState(),this._listenEvents(),this.navigate(this._options.initialRoute)}get currentRoute(){return this._currentRoute}navigate(e,t){let s=new URLSearchParams(t),n=s.toString(),i=this.query.toString();(e!=this._currentRoute||n!==i)&&(this.query=s,this._history.pushState("data","",e+(n?"?"+n:"")))}async _setRoute(){this._currentTag&&await this._currentTag.hide();let e=this._getRoute();e.parent?await e.show():(this._hookLifecycle(e),this._rootParent.append(e)),this._currentTag=e}_hookLifecycle(e){let t=this._options;!t.remove&&!t.start||b(e,t.start?t.start:null,t.remove?t.remove:null,t.beforeRemove?t.beforeRemove:null)}_getEffectiveRoute(){let e=this._currentRoute,t=1e4,s;for(;typeof(s=this._options.routes[e])=="string"&&t--&&typeof s=="string";)e=s;return e}_getRoute(){let e=this._getEffectiveRoute(),t=e,s=!1,n=this._options;this.query=new URLSearchParams(this._location.search);for(let{matcher:o,key:a}of this._routeMatchers){let l=o.parse(t);if(l){this.params=l,t=a,s=!0;break}}if(s||(t=n.fallbackRoute),!(t in n.routes))return n.noRouteBuilder?n.noRouteBuilder(this):ie("No route found for: "+e);if(this._routes[t])return this._routes[t].show(),this._routes[t];let i=n.routes[t];if(typeof i!="function")throw new Error("Can find route builder for "+this._currentRoute);return this._routes[t]=i(this)}_setCurrentRoute(){this.currentRoute!=this._location.pathname&&(this._currentRoute=this._location.pathname,this._setRoute())}_listenEvents(){this._window.addEventListener("popstate",this._setCurrentRoute.bind(this)),this._window.addEventListener("pushstate",this._setCurrentRoute.bind(this))}_modifyPushState(){let e=this._history.pushState;this._history.pushState=(...t)=>{e.call(this._history,...t),this._window.dispatchEvent(new window.Event("pushstate"))}}_initRouteMatchers(){for(let e in this._options.routes)this._routeMatchers.push({key:e,matcher:G(e)})}},w;function Q(r){return w=new x(r)}function Z(r,e,t){return ae(r).addAttr("href","javascript:;").setStyle({margin:"0 8px 0 0"}).clicked(()=>{if(!w)throw new Error("Link can	 navigate, there is no router available");w.navigate(e,t)})}var oe={...A,...O,...P,...L,...N,...K,...j};return re(le);})();
